<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G√©olocalisation et M√©t√©o</title>
</head>
<body>
    <h1>G√©olocalisation & M√©t√©o</h1>
    <button onclick="getLocation()">Obtenir ma position et la m√©t√©o</button>
    <p id="position"></p>
    <p id="weather"></p>
    <p id="season"></p> <!-- Ajout de l'affichage de la saison -->

    <script>
        const API_KEY = "573df8eb65077b5957de5861a32b9631"; // Remplace par ta cl√© API OpenWeatherMap

        function getLocation() {
            if ("geolocation" in navigator) {
                navigator.geolocation.getCurrentPosition(
                    async (position) => {
                        let lat = position.coords.latitude;
                        let lon = position.coords.longitude;

                        // R√©cup√©rer le nom du lieu exact (ville, wilaya, pays)
                        let locationName = await getLocationName(lat, lon);
                        document.getElementById("position").innerText = 
                            `Latitude: ${lat}, Longitude: ${lon}\nLieu: ${locationName}`;

                        // R√©cup√©rer les donn√©es m√©t√©orologiques
                        let weatherData = await getWeather(lat, lon);
                        document.getElementById("weather").innerText = weatherData;

                        // D√©terminer la saison actuelle
                        let season = getSeason(lat);
                        document.getElementById("season").innerText = `Saison: ${season}`;
                    },
                    (error) => {
                        console.error("Erreur de g√©olocalisation: ", error.message);
                    }
                );
            } else {
                console.log("La g√©olocalisation n'est pas support√©e par ce navigateur.");
            }
        }

        // Fonction pour r√©cup√©rer le nom du lieu avec OpenStreetMap (Nominatim)
        async function getLocationName(lat, lon) {
            try {
                let response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&accept-language=fr`);
                let data = await response.json();
                
                if (data && data.address) {
                    return `${data.address.city || data.address.town || data.address.village}, ${data.address.state}, ${data.address.country}`;
                } else {
                    return "Lieu inconnu";
                }
            } catch (error) {
                console.error("Erreur lors de la r√©cup√©ration du nom du lieu :", error);
                return "Erreur";
            }
        }

        async function getWeather(lat, lon) {
    try {
        let response = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric&lang=fr`);
        let data = await response.json();

        console.log("Donn√©es OpenWeatherMap:", data); // V√©rifie la r√©ponse de l'API

        if (data && data.weather) {
            let description = data.weather[0].description;
            let temperature = data.main.temp;
            return `M√©t√©o: ${description}, Temp√©rature: ${temperature}¬∞C`;
        } else {
            return "Donn√©es m√©t√©o indisponibles";
        }
    } catch (error) {
        console.error("Erreur lors de la r√©cup√©ration des donn√©es m√©t√©o :", error);
        return "Erreur";
    }
}


        // Fonction pour d√©terminer la saison en fonction de la latitude et du mois actuel
        function getSeason(lat) {
            let month = new Date().getMonth() + 1; // Mois actuel (1 = Janvier, 12 = D√©cembre)

            if (lat >= 0) { // H√©misph√®re Nord (ex: Alg√©rie, France)
                if (month >= 3 && month <= 5) return "Printemps üå∏";
                if (month >= 6 && month <= 8) return "√ât√© ‚òÄÔ∏è";
                if (month >= 9 && month <= 11) return "Automne üçÇ";
                return "Hiver ‚ùÑÔ∏è"; // D√©cembre - F√©vrier
            } else { // H√©misph√®re Sud (ex: Br√©sil, Australie)
                if (month >= 3 && month <= 5) return "Automne üçÇ";
                if (month >= 6 && month <= 8) return "Hiver ‚ùÑÔ∏è";
                if (month >= 9 && month <= 11) return "Printemps üå∏";
                return "√ât√© ‚òÄÔ∏è"; // D√©cembre - F√©vrier
            }
        }
    </script>
</body>
</html>
